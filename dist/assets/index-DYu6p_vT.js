import{C as xe,S as ct,a as Oe,F as dt,H as ut,b as pt,D as mt,c as yt,A as _t,P as ht,W as St,G as Fe,V as v,B as Y,R as ve,d as gt,e as bt,f as ce}from"./three-Dhj7f3wh.js";import{O as p}from"./@dimforge-D3Mqfikn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Ge(){let e=window.matchMedia||window.msMatchMedia;return e?e("(pointer:coarse)").matches:!1}function Je(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function O(e){const t=e/1e3,o=Math.floor(t),i=Math.floor((t-o)*1e3),a=Math.floor(o/60),l=o%60;return`${String(a).padStart(2,"0")}:${String(l).padStart(2,"0")}.${String(i).padStart(3,"0")}`}let N=document.querySelector(".main_load"),je=document.querySelector(".main_menu"),Ne=document.querySelector(".select_level"),qe=document.querySelectorAll(".select_level .level_shadow"),ft=document.querySelector(".select_tube"),Dt=document.querySelector(".finish_window"),wt=document.querySelector(".finish_you_time .finish_you_time_time"),We=document.querySelector(".boom_window"),de=document.querySelector(".main_record"),xt=document.querySelectorAll("body>.overlay"),vt=document.querySelector(".startButton"),qt=document.querySelectorAll(".load_level_wrap .btn_lev"),Ve=document.querySelectorAll(".load_level_wrap .level_time"),Ke=document.querySelectorAll(".load_tubes_wrap>div"),ne=document.querySelectorAll(".language_block img"),Ue=[],Ye=[],G,Qe=document.querySelector(".times"),Le=document.querySelector(".current_time"),$e=document.querySelector(".best_time"),Lt=document.querySelector(".finish_window .finish_again"),Ct=document.querySelector(".finish_window .finish_in_menu"),kt=document.querySelector(".boom_window .finish_again"),At=document.querySelector(".boom_window .finish_in_menu"),Xe=document.querySelector(".speed_block"),Ze=document.querySelector(".speed_block>.speed"),zt=document.querySelector(".instr_check"),ue=document.querySelector(".load_percent");document.querySelector(".records_wrap>div");let Ce=document.querySelector(".pause_button_wrap"),Et=document.querySelector(".close_pause_button"),Tt=document.querySelector(".reset_button"),Rt=document.querySelector(".inmenu_button"),Mt=document.querySelector(".before_start"),It=document.querySelector(".instruction_start_btn"),Ht=document.querySelector(".menu_in_game_wrap"),ke=document.querySelector(".start_time"),et=document.querySelector(".start_time_wrap"),pe=document.querySelector(".audio_button");window.oncontextmenu=function(e){return!1},ne.forEach((e,t)=>{e.addEventListener("click",()=>{G!=t&&(ne.forEach(o=>{o.classList.remove("selected")}),e.classList.add("selected"),G=t,Ae(G))})});function Ae(e){e==0?(document.querySelector(".title_game").src="./images/title.png",document.querySelector(".startgame_title").textContent="\u043D\u0430\u0447\u0430\u0442\u044C \u0438\u0433\u0440\u0443",document.querySelector(".language_title").textContent="\u042F\u0437\u044B\u043A:",document.querySelectorAll(".level_text h2>span").forEach(t=>{t.textContent="\u0423\u0440\u043E\u0432\u0435\u043D\u044C"}),document.querySelectorAll(".leveltime_title").forEach(t=>{t.textContent="\u0412\u0440\u0435\u043C\u044F: "}),document.querySelectorAll(".load_tubes_wrap .selecttube_title").forEach(t=>{t.textContent="\u0422\u044E\u0431\u0438\u043D\u0433"}),document.querySelectorAll(".load_tubes_wrap .selecttubespeed_title").forEach(t=>{t.textContent="\u0421\u043A\u043E\u0440\u043E\u0441\u0442\u044C: "}),document.querySelectorAll(".load_tubes_wrap .selecttubecontrol_title").forEach(t=>{t.textContent="\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435: "}),document.querySelectorAll(".load_level_wrap .btn_lev").forEach(t=>{t.textContent="\u041D\u0430\u0447\u0430\u0442\u044C"}),document.querySelectorAll(".load_level_wrap .ad_res").forEach(t=>{t.textContent="\u041F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u044C"}),document.querySelector(".selecttubedesc_title").textContent="\u041F\u0440\u043E\u0445\u043E\u0434\u0438\u0442\u0435 \u0443\u0440\u043E\u0432\u043D\u0438, \u0447\u0442\u043E\u0431\u044B \u0440\u0430\u0437\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0442\u044E\u0431\u0438\u043D\u0433\u0438",document.querySelector(".menu_in_game_wrap_head").textContent="\u041F\u0430\u0443\u0437\u0430",document.querySelector(".close_pause_button").textContent="\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u0438\u0433\u0440\u0443",document.querySelector(".reset_button").textContent="\u041D\u0430\u0447\u0430\u0442\u044C \u0437\u0430\u043D\u043E\u0432\u043E",document.querySelector(".inmenu_button").textContent="\u0412\u044B\u0439\u0442\u0438",document.querySelector(".finish_you_time_title").textContent="\u0412\u0430\u0448\u0435 \u0432\u0440\u0435\u043C\u044F: ",document.querySelector(".crash_title").textContent="\u0412\u044B \u0432\u0440\u0435\u0437\u0430\u043B\u0438\u0441\u044C",document.querySelector(".finish_title").textContent="\u0412\u044B \u043F\u0440\u0438\u0435\u0445\u0430\u043B\u0438",document.querySelectorAll(".finish_again").forEach(t=>{t.textContent="\u0415\u0449\u0435 \u0440\u0430\u0437"}),document.querySelectorAll(".finish_in_menu").forEach(t=>{t.textContent="\u0412\u044B\u0431\u043E\u0440 \u0443\u0440\u043E\u0432\u043D\u044F"}),document.querySelector(".current_time_title").textContent="\u0412\u0440\u0435\u043C\u044F",document.querySelector(".best_time_title").textContent="\u041B\u0443\u0447\u0448\u0435\u0435 \u0432\u0440\u0435\u043C\u044F",document.querySelector(".speed_title").textContent="\u041A\u041C/\u0427",document.querySelector(".instruction_start_btn").textContent="\u0421\u0422\u0410\u0420\u0422",document.querySelector(".instr-disabled span").textContent="\u0411\u043E\u043B\u044C\u0448\u0435 \u043D\u0435 \u043F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0442\u044C",document.querySelector(".desktop_instr").innerHTML=`<h2>\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435</h2>
    <span>\u0411\u044B\u0441\u0442\u0440\u043E \u043D\u0430\u0436\u0438\u043C\u0430\u0439\u0442\u0435 <span class='button_active'>W</span> \u0438\u043B\u0438 <span class='button_active'>\u2191</span> \u0447\u0442\u043E\u0431\u044B \u0440\u0430\u0437\u043E\u0433\u043D\u0430\u0442\u044C\u0441\u044F \u0434\u043E \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0439 \u043E\u0442\u043C\u0435\u0442\u043A\u0438</span>
    <span>\u041A\u043B\u0430\u0432\u0438\u0448\u0430\u043C\u0438 <span>\u2190</span> <span>\u2192</span> \u0438\u043B\u0438 <span>A</span> <span>D</span> \u0443\u043F\u0440\u0430\u0432\u043B\u044F\u0439\u0442\u0435 \u0442\u044E\u0431\u0438\u043D\u0433\u043E\u043C</span>`,document.querySelector(".mobile_instr div").innerHTML=`<span>\u0411\u044B\u0441\u0442\u0440\u043E \u043D\u0430\u0436\u0438\u043C\u0430\u0439\u0442\u0435 \u043D\u0430 \u0437\u043E\u043D\u0443 <span> \u2191 </span> \u0447\u0442\u043E\u0431\u044B \u0440\u0430\u0437\u043E\u0433\u043D\u0430\u0442\u044C\u0441\u044F \u0434\u043E \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0439 \u043E\u0442\u043C\u0435\u0442\u043A\u0438</span>
    <span>\u041D\u0430\u0436\u0438\u043C\u0430\u044F \u043D\u0430 \u0437\u043E\u043D\u044B <span> \u2190 </span> \u0438 <span> \u2192 </span> \u0443\u043F\u0440\u0430\u0432\u043B\u044F\u0439\u0442\u0435 \u0442\u044E\u0431\u0438\u043D\u0433\u043E\u043C</span>`,document.querySelector(".sci-fi-loader strong").textContent="\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430",document.querySelector(".main_record_title").textContent="\u041C\u043E\u0435 \u043E\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043C\u044F: ",M==0&&(document.querySelector(".main_record").textContent="\u041F\u0440\u043E\u0439\u0434\u0438\u0442\u0435 \u0432\u0441\u0435 \u0443\u0440\u043E\u0432\u043D\u0438, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0440\u0435\u043A\u043E\u0440\u0434"),document.querySelector(".records_wrap>p").textContent="\u041C\u0438\u0440\u043E\u0432\u043E\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",document.querySelector(".need_auth_text").textContent="\u0427\u0442\u043E\u0431\u044B \u0443\u0447\u0430\u0441\u0442\u0432\u043E\u0432\u0430\u0442\u044C \u0432 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0435  ",document.querySelector(".auth_link").textContent="\u0432\u043E\u0439\u0434\u0438\u0442\u0435 \u0432 \u0430\u043A\u043A\u0430\u0443\u043D\u0442",document.querySelector(".svg_text").textContent="\u0411\u044B\u0441\u0442\u0440\u043E \u043D\u0430\u0436\u0438\u043C\u0430\u0439\u0442\u0435 \u043D\u0430 \u0432\u0435\u0440\u0445\u043D\u044E\u044E \u0447\u0430\u0441\u0442\u044C \u044D\u043A\u0440\u0430\u043D\u0430, \u0447\u0442\u043E\u0431\u044B \u0440\u0430\u0437\u043E\u0433\u043D\u0430\u0442\u044C\u0441\u044F \u0434\u043E \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0439 \u043E\u0442\u043C\u0435\u0442\u043A\u0438!",document.querySelector(".svg_text_left").textContent="\u0412\u043B\u0435\u0432\u043E",document.querySelector(".svg_text_right").textContent="\u0412\u043F\u0440\u0430\u0432\u043E"):(document.querySelector(".title_game").src="./images/title-en.png",document.querySelector(".startgame_title").textContent="start game",document.querySelector(".language_title").textContent="Language:",document.querySelectorAll(".level_text h2>span").forEach(t=>{t.textContent="Level"}),document.querySelectorAll(".leveltime_title").forEach(t=>{t.textContent="Time: "}),document.querySelectorAll(".load_tubes_wrap .selecttube_title").forEach(t=>{t.textContent="Tubing"}),document.querySelectorAll(".load_tubes_wrap .selecttubespeed_title").forEach(t=>{t.textContent="Speed: "}),document.querySelectorAll(".load_tubes_wrap .selecttubecontrol_title").forEach(t=>{t.textContent="Control: "}),document.querySelector(".selecttubedesc_title").textContent="Complete the levels to unlock the tubings",document.querySelector(".menu_in_game_wrap_head").textContent="Pause",document.querySelector(".close_pause_button").textContent="Continue",document.querySelector(".reset_button").textContent="Start again",document.querySelector(".inmenu_button").textContent="Exit to levels",document.querySelector(".finish_you_time_title").textContent="You time: ",document.querySelector(".crash_title").textContent="You crashed",document.querySelector(".finish_title").textContent="You finished",document.querySelectorAll(".finish_again").forEach(t=>{t.textContent="Again"}),document.querySelectorAll(".finish_in_menu").forEach(t=>{t.textContent="Select Level"}),document.querySelector(".current_time_title").textContent="Time",document.querySelector(".best_time_title").textContent="Best time",document.querySelector(".speed_title").textContent="KM/H",document.querySelector(".instruction_start_btn").textContent="START",document.querySelector(".instr-disabled span").textContent="Don't show again",document.querySelector(".desktop_instr").innerHTML=`<h2>Instructions</h2>
    <span>Quickly press <span class='button_active'>W</span> or <span class='button_active'>\u2191</span> to accelerate to the starting point</span>
    <span>Use <span>\u2190</span> <span>\u2192</span> or <span>A</span> <span>D</span> keys to control the tubing</span>`,document.querySelector(".mobile_instr div").innerHTML=`<span>Quickly press on zone <span> \u2191 </span> to accelerate to the starting point</span>
    <span>By taps on zones <span> \u2190 </span> and <span> \u2192 </span> control the tubing</span>`,document.querySelector(".sci-fi-loader strong").textContent="Loading ",document.querySelector(".main_record_title").textContent="My total time: ",M==0&&(document.querySelector(".main_record").textContent="Complete all the levels to set a record"),document.querySelector(".records_wrap>p").textContent="World Ranking: ",document.querySelector(".need_auth_text").textContent="To participate in the rating ",document.querySelector(".auth_link").textContent="login to account",document.querySelectorAll(".load_level_wrap .btn_lev").forEach(t=>{t.textContent="Start"}),document.querySelectorAll(".load_level_wrap .ad_res").forEach(t=>{t.textContent="Skip"}),document.querySelector(".svg_text").textContent="Quickly tap on the top of the screen to accelerate to the starting flag!",document.querySelector(".svg_text_left").textContent="LEFT",document.querySelector(".svg_text_right").textContent="RIGHT")}document.querySelectorAll(".load_level_wrap .ad_res").forEach((e,t)=>{e.addEventListener("click",async()=>{ysdk.adv.showRewardedVideo({callbacks:{onOpen:()=>{console.log("Video ad open."),he=!0,r!=null&&r.isPlaying&&r.stop()},onRewarded:async()=>{console.log("Rewarded! "+t),g(N),_.levelsTimes["time"+(t+1)]=120.111,ae=Object.keys(_.levelsTimes).length,localStorage.setItem("playerData",JSON.stringify(_)),await U(),await ie()},onClose:()=>{console.log("Video ad closed."),r!=null&&!r.isPlaying&&w&&r.play(),he=!1},onError:o=>{console.log("Error while open video ad:",o),r!=null&&!r.isPlaying&&w&&r.play()}}})})}),qt.forEach((e,t)=>{e.addEventListener("click",async()=>{t+1<=Be+1&&(W=t+1,Ke.forEach((o,i)=>{y[i].levels.includes(W)?(o.classList.remove("disabledTube"),y[i].canInLevel=!0):(o.classList.add("disabledTube"),y[i].canInLevel=!1)}),g(N),await le(!1,!0),g(ft))})}),Ke.forEach((e,t)=>{e.addEventListener("click",()=>{y[t].canInLevel&&(h=t,g(0),oe())})});function oe(){if(!_.canStart)g(Mt),E?document.querySelector(".mobile_instr").classList.remove("hidden_instr"):document.querySelector(".desktop_instr").classList.remove("hidden_instr");else{Qe.classList.remove("hidden_block"),Xe.classList.remove("hidden_block"),ye[h].position.copy(c.translation());let e=0;Te=!0,E&&document.querySelector(".instr-mobile-ingame").classList.remove("hidden_block"),E&&document.querySelector(".anim_tap_top").classList.remove("hidden_block");let t=setInterval(o=>{f!=null&&!f.isPlaying&&w&&!se&&e==0&&f.play(),et.classList.remove("hidden_block"),se||e++,e==2&&E&&document.querySelector(".instr-mobile-ingame").classList.add("hidden_block"),e==4?(Te=!1,G==0?ke.textContent="\u0421\u0422\u0410\u0420\u0422":ke.textContent="GO",I=!0,Ce.classList.remove("hidden_block"),clearInterval(t),ysdk.features.GameplayAPI.start(),setTimeout(()=>{et.classList.add("hidden_block"),f==null||f.stop(),Object.keys(_.levelsTimes).length==0&&document.querySelector(".svg_text").classList.remove("hidden_block")},1500)):ke.textContent=4-e},1e3)}}It.addEventListener("click",()=>{_.canStart=!0,g(0),oe()}),pe.addEventListener("click",()=>{w==!0?(pe.classList.add("audio_off"),r!=null&&r.isPlaying&&r.stop(),d!=null&&d.isPlaying&&d.stop(),f!=null&&f.isPlaying&&f.stop(),w=!1):(pe.classList.remove("audio_off"),r!=null&&!r.isPlaying&&r.play(),c.linvel().z>3&&n.userData.onGround&&!F&&(d==null||d.play()),w=!0)}),vt.addEventListener("click",()=>{E=Ge(),Pe=Je(),Pe&&pe.classList.add("hidden_block"),G==0?_e=tt:_e=nt,document.querySelector(".audio_button_wrap").classList.remove("hidden_block"),r!=null&&w&&r.play(),je.classList.add("hidden_block"),Ne.classList.remove("hidden_block")});function g(e){xt.forEach(t=>{t.classList.add("hidden_block")}),e!=0&&e.classList.remove("hidden_block")}Lt.addEventListener("click",async()=>{g(N),await U(),await le(!0,!0),g(0),oe()}),kt.addEventListener("click",async()=>{g(N),await U(),await le(!0,!0),g(0),oe()}),Tt.addEventListener("click",async()=>{await U(),await le(!0,!0),g(0),oe()}),Ct.addEventListener("click",async()=>{g(N),await U(),await ie(),ysdk.adv.showFullscreenAdv({callbacks:{onOpen:function(e){r!=null&&r.isPlaying&&r.stop()},onClose:function(e){r!=null&&!r.isPlaying&&w&&r.play()},onError:function(e){r!=null&&!r.isPlaying&&w&&r.play()}}})}),At.addEventListener("click",async()=>{g(N),await U(),await ie()}),Rt.addEventListener("click",async()=>{g(N),await U(),await ie()}),Ce.addEventListener("click",()=>{var e;Te==!1&&I&&!A&&((e=ysdk.features.GameplayAPI)==null||e.stop(),g(Ht),n.userData.time=k.getElapsedTime(),k.stop(),document.querySelector(".audio_button_wrap").classList.add("hidden_block"),d==null||d.stop(),r==null||r.stop(),F=!0)}),Et.addEventListener("click",()=>{var e;g(0),k.start(),k.elapsedTime=n.userData.time,document.querySelector(".audio_button_wrap").classList.remove("hidden_block"),w&&(r==null||r.play()),c.linvel().z>3&&n.userData.onGround&&w&&(d==null||d.play()),F=!1,(e=ysdk.features.GameplayAPI)==null||e.start()}),zt.onchange=function(){this.checked?(_.canStart=!0,localStorage.setItem("playerData",JSON.stringify(_))):(_.canStart=!1,localStorage.setItem("playerData",JSON.stringify(_)))};let m,ze=!0;performance.now();let W=0,F=!1,w=!0,M=0,Q=0,ae=0,me,$=!1,n,c,Ee,Te=!1,ye=[],h=0,J,_e,tt,nt,se=!1,he=!1,Re,A;const y=[{hSpeed:10,maxHSpeed:.08,stepSpeed:1,nowSpeed:0,maxSpeed:26,resetHAngle:!1,levels:[1,2,3,4,5,6,7,8,9],canInLevel:!1},{hSpeed:12,maxHSpeed:.1,stepSpeed:2,nowSpeed:0,maxSpeed:38,resetHAngle:!1,levels:[4,5,6,7,8,9],canInLevel:!1},{hSpeed:14,maxHSpeed:.12,stepSpeed:2,nowSpeed:0,maxSpeed:44,resetHAngle:!0,levels:[7,8,9],canInLevel:!1}];let d,r,z,f,ot,q=[],X=new v,Pt=new ve,I=!1,Me=!1,Z,at,st,b,H,P,L,C,Se,ge,be,ee,te,Ie,V=[],fe=[],He=[],D,E=Ge(),Pe=Je(),Bt=new xe,k=new xe,De=0,rt=1/60,K=0,T=0,Be=2,_;const it=new ve,Ot=new v(0,-1,0),u=new ct;u.background=new Oe(0),u.fog=new dt(new Oe(0),1,350);const re=new ut(0,0,2);re.color.setHSL(.6,1,.6),re.groundColor.setHSL(.095,1,.75),re.position.set(0,100,0),new pt(re,10);const we=new mt(0,3);we.position.set(1,2,.2),we.position.multiplyScalar(120),new yt(we,10),new _t(11184810,1);const x=new ht(85,document.body.offsetWidth/document.body.offsetHeight,.1,310);x.position.set(0,4,-10);const j=new St({antialias:!1});j.setSize(document.body.offsetWidth,document.body.offsetHeight),document.body.appendChild(j.domElement),j.shadowMap.enabled=!1,window.addEventListener("resize",Ft,!1);function Ft(){E?(x.aspect=document.body.offsetWidth/document.body.offsetHeight,x.updateProjectionMatrix(),j.setSize(innerWidth,innerHeight)):(x.aspect=document.body.offsetWidth/document.body.offsetHeight,x.updateProjectionMatrix(),j.setSize(document.body.offsetWidth,document.body.offsetHeight))}async function Gt(){localStorage.getItem("playerData")?(_=JSON.parse(localStorage.getItem("playerData")),ne.forEach(e=>{e.classList.remove("selected")}),ae=Object.keys(_.levelsTimes).length,ae==qe.length&&(M=0,Object.values(_.levelsTimes).forEach(e=>{M+=parseFloat(e)}),de.textContent=O(Math.round(M*1e3)),de.classList.add("main_record_green"))):(_={levelsTimes:{},canStart:!1},localStorage.setItem("playerData",JSON.stringify(_))),JSON.stringify(_),Be=0,qe.forEach((e,t)=>{t<Object.keys(_.levelsTimes).length+1&&(Be++,e.classList.remove("level_disabled"))}),Ve.forEach((e,t,o)=>{_.levelsTimes["time"+(t+1)]!=null?(e.childNodes[2].textContent=_.levelsTimes["time"+(t+1)],document.querySelectorAll(".load_level_wrap .ad_res").forEach((i,a)=>{(t==a||a==Ve.length-1)&&i.classList.add("not_vis")})):e.childNodes[2].textContent="00.000"})}async function Jt(){k=new xe,u.add(we),u.add(re),T=0,await p.init(),m=new p.World(new p.Vector3(0,-9.81,0)),await new Fe().loadAsync("models/map-menu-noob.glb",onprogress=l=>{let S=Math.min(Math.round(l.loaded/l.total*100),100);ue.textContent=S+"%"}).then(l=>{const S=l.scene;ue.textContent="0",S.traverse(s=>{if(s.name=="player")n=s.clone(),n.userData.vertices=n.geometry.attributes.position.array,n.userData.indices=n.geometry.index.array,n.material.transparent=!0,n.material.opacity=0,n.userData.mass=1,n.userData.playerBraking=!1,n.userData.hTransition=0,n.userData.currentSpeed=0,n.userData.boom=!1,n.userData.onStartArea=!0,n.userData.canBoostStep=!0,n.userData.time=0,n.userData.right=!1,n.userData.left=!1,n.userData.onGround=!1,n.userData.flying=!1,n.userData.origPosition=n.position,R(n),u.add(n);else if(s.name.includes("player-tube"))J=s.clone(),J.userData.startPosition=new v(J.position.x,J.position.y,J.position.z),ye[s.name.slice(-1)-1]=J,u.add(J);else if(s.name=="arrow_area")D=s.clone(),D.userData.hPos=0,u.add(D);else if(s.name.includes("ground"))new Y().setFromObject(s).getSize(new v),Z=s.clone(),Z.userData.mass=0,R(Z),V.push(Z),u.add(Z),s.name=="left_ground_wall"?at=s.position:s.name=="right_ground_wall"&&(st=s.position);else if(s.name.includes("wall")){new Y().setFromObject(s).getSize(new v);let B=s.clone();B.userData.mass=1,R(B),V.push(B),fe.push(B),u.add(B)}else if(s.name.includes("area")){let B=s.clone();u.add(B)}else s.name.includes("start_flag_en")?nt=s.clone():s.name.includes("start_flag_ru")?tt=s.clone():s.name.includes("itsmen_body")?(b=s.clone(),b.material.transparent=!0,b.material.opacity=0,u.add(b),R(b)):s.name.includes("itsmen_left_hand")?(H=s.clone(),H.material.transparent=!0,H.material.opacity=0,u.add(H),R(H)):s.name.includes("itsmen_right_hand")?(P=s.clone(),P.material.transparent=!0,P.material.opacity=0,u.add(P),R(P)):s.name.includes("itsmen_left_leg")?(L=s.clone(),L.material.transparent=!0,L.material.opacity=0,u.add(L),R(L)):s.name.includes("itsmen_right_leg")?(C=s.clone(),C.material.transparent=!0,C.material.opacity=0,u.add(C),R(C)):s.name.includes("qmen_body")?(Se=s.clone(),u.add(Se)):s.name.includes("qmen_left_hand")?(ge=s.clone(),u.add(ge)):s.name.includes("qmen_right_hand")?(be=s.clone(),u.add(be)):s.name.includes("qmen_left_leg")?(ee=s.clone(),u.add(ee)):s.name.includes("qmen_right_leg")&&(te=s.clone(),u.add(te))})}),u.traverse(function(l){l.material&&(l.material.needsUpdate=!0)}),await Gt();let e=p.JointData.spherical({x:.3,y:-0,z:-.2},{x:-.4,y:0,z:0});m.createImpulseJoint(e,b.userData.body,H.userData.body,!0);let t=p.JointData.spherical({x:-.3,y:-0,z:-.2},{x:.4,y:0,z:0});m.createImpulseJoint(t,b.userData.body,P.userData.body,!0);let o=p.JointData.spherical({x:.2,y:.2,z:.4},{x:0,y:.1,z:-.5});m.createImpulseJoint(o,b.userData.body,L.userData.body,!0);let i=p.JointData.spherical({x:-.2,y:.2,z:.4},{x:0,y:.1,z:-.5});m.createImpulseJoint(i,b.userData.body,C.userData.body,!0);let a=p.JointData.spherical({x:0,y:0,z:0},{x:0,y:.7,z:0});Ie=m.createImpulseJoint(a,b.userData.body,c,!0),Me=!0}async function jt(){u.add(_e),A=!1;const e=new Fe,t="models/map"+W+".glb";await e.loadAsync(t,onprogress=o=>{let i=Math.min(Math.round(o.loaded/o.total*100),100);ue.textContent=i+"%"}).then(o=>{const i=o.scene;ue.textContent="0",i.traverse(a=>{if(a.name.includes("ground")){new Y().setFromObject(a).getSize(new v);let l=a.clone();l.userData.mass=0,l.name=a.name,R(l),V.push(l),u.add(l)}else if(a.name.includes("wall")){new Y().setFromObject(a).getSize(new v);let l=a.clone();l.userData.mass=1,R(l),V.push(l),fe.push(l),u.add(l)}else if(a.name.includes("moving_block")){const l=new Y().setFromObject(a).getSize(new v);let S=a.clone();S.userData.size=l,S.userData.mass=1,S.userData.raycaster=new ve,S.userData.speed=-a.name.substr(a.name.indexOf("speed")+6),S.userData.direction=new v(S.userData.speed,0,0),Ue.push(S),R(S),fe.push(S),u.add(S)}else if(a.name.includes("area")){let l=a.clone();u.add(l)}else a.name.includes("finish_block")&&(Re=a.clone(),u.add(Re))})}),$e.textContent=_.levelsTimes["time"+W]}async function Nt(){const e=new gt,t=new bt;await t.loadAsync("audio/slide.mp3").then(o=>{d=new ce(e),d.setBuffer(o),d.setLoop(!0),d.setRefDistance(400),d.setVolume(.7),n.add(d)}).catch(o=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0430\u0443\u0434\u0438\u043E:",o)}),await t.loadAsync("audio/around.mp3").then(o=>{r=new ce(e),r.setBuffer(o),r.setLoop(!0),r.setRefDistance(400),r.setVolume(1),r.error=!1,n.add(r)}).catch(o=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0430\u0443\u0434\u0438\u043E:",o)}),await t.loadAsync("audio/boom1.mp3").then(o=>{z=new ce(e),z.setBuffer(o),z.setLoop(!1),z.setRefDistance(400),z.setVolume(.3),z.error=!1,n.add(z)}).catch(o=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0430\u0443\u0434\u0438\u043E:",o)}),await t.loadAsync("audio/bip.mp3").then(o=>{f=new ce(e),f.setBuffer(o),f.setLoop(!1),f.setRefDistance(400),f.setVolume(.3),f.error=!1,n.add(f)}).catch(o=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0430\u0443\u0434\u0438\u043E:",o)})}document.querySelector(".auth_link").addEventListener("click",()=>{ysdk.auth.openAuthDialog().then(()=>{ysdk.isAvailableMethod("leaderboards.setLeaderboardScore").then(e=>{$=e,ysdk.getLeaderboards().then(t=>{me=t,t.getLeaderboardEntries("main",{quantityTop:3,includeUser:$,quantityAround:0}).then(o=>{document.querySelector(".records_wrap>div").innerHTML="",G==0?document.querySelector(".need_auth").textContent="\u0412\u044B \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043B\u0438\u0441\u044C! \u041C\u043E\u0436\u0435\u0442\u0435 \u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0440\u0435\u043A\u043E\u0440\u0434\u044B!":document.querySelector(".need_auth").textContent="You have logged in! You can set records!",document.querySelector(".need_auth").classList.add("green"),o.entries.forEach((i,a)=>{o.userRank==i.rank?(Q=O(i.score),document.querySelector(".records_wrap>div").innerHTML=document.querySelector(".records_wrap>div").innerHTML+'<p class = "main_record_green">'+parseInt(i.rank)+". "+O(i.score)+"</p>"):document.querySelector(".records_wrap>div").innerHTML=document.querySelector(".records_wrap>div").innerHTML+"<p>"+parseInt(a+1)+". "+O(i.score)+"</p>"})})})}),initPlayer().catch(e=>{})}).catch(()=>{})});async function ie(){await le(!0,!1),ze?(YaGames.init().then(e=>{var t;(t=e.features.LoadingAPI)==null||t.ready(),e.adv.showFullscreenAdv({callbacks:{onOpen:function(o){r!=null&&r.isPlaying&&r.stop(),g(je)},onClose:function(o){},onError:function(o){}}}),e.environment.i18n.lang=="ru"||e.environment.i18n.lang=="be"||e.environment.i18n.lang=="kk"||e.environment.i18n.lang=="uk"||e.environment.i18n.lang=="uz"?(ne[0].classList.add("selected"),Ae(0),G=0):(ne[1].classList.add("selected"),Ae(1),G=1),e.isAvailableMethod("leaderboards.setLeaderboardScore").then(o=>{$=o,$&&document.querySelector(".need_auth").classList.add("hidden_block"),e.getLeaderboards().then(i=>{me=i,i.getLeaderboardEntries("main",{quantityTop:3,includeUser:$,quantityAround:0}).then(a=>{a.entries.forEach((l,S)=>{a.userRank==l.rank?(Q=l.score,document.querySelector(".records_wrap>div").innerHTML=document.querySelector(".records_wrap>div").innerHTML+'<p class = "main_record_green">'+parseInt(l.rank)+". "+O(l.score)+"</p>"):document.querySelector(".records_wrap>div").innerHTML=document.querySelector(".records_wrap>div").innerHTML+"<p>"+parseInt(S+1)+". "+O(l.score)+"</p>"})})})})}),ze=!1):g(Ne)}ie();async function le(e,t){e&&await Jt(),t&&await jt(),ze&&!Pe&&Nt()}async function U(){for(I=!1,Me=!1,T=0,n.userData.time=0,n.userData.boom=!1,y.forEach(e=>{e.nowSpeed=0}),V=[],fe=[],q=[],Ce.classList.add("hidden_block"),Qe.classList.add("hidden_block"),Xe.classList.add("hidden_block"),document.querySelector(".audio_button_wrap").classList.remove("hidden_block"),k.start(),k.elapsedTime=n.userData.time,F=!1,n.userData.currentSpeed=0,Ze.textContent=n.userData.currentSpeed,T=0,Le.textContent=T;u.children.length>0;){let e=u.children[0];e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>t.dispose()):e.material.dispose()),u.remove(e)}A=!1,r!=null&&w&&!se&&!he&&r.play()}function Wt(){if(Me&&!A&&(d!=null&&w&&(c.linvel().z>3&&n.userData.onGround?d.isPlaying||d.play():d.isPlaying&&d.stop()),E?n.userData.boom?(x.lookAt(b.position),d==null||d.stop()):(x.lookAt(new v(x.position.x,n.position.y,n.position.z+5)),x.position.y=n.position.y+5,x.position.z=n.position.z-3):n.userData.boom?(J.position.y>0&&x.lookAt(b.position),d==null||d.stop()):(x.lookAt(new v(x.position.x,n.position.y,n.position.z+5)),x.position.y=n.position.y+4,x.position.z=n.position.z-4),D.position.set(n.position.x,n.position.y,n.position.z+5)),I){A?(g(Dt),d==null||d.stop()):(T=k.getElapsedTime().toFixed(3),Le.textContent=T,Kt(),Vt()),n.position.x>at.x-n.userData.size.x/1.3&&(D.position.x=n.position.x,n.userData.hTransition=-.4),n.position.x<st.x+n.userData.size.x/1.3&&(D.position.x=n.position.x,n.userData.hTransition=.4);let e=new p.EventQueue(!0);m.step(e),ye[h].position.copy(c.translation()),ye[h].quaternion.copy(c.rotation()),Se.position.copy(b.position),Se.rotation.copy(b.rotation),ge.position.copy(H.position),ge.rotation.copy(H.rotation),be.position.copy(P.position),be.rotation.copy(P.rotation),ee.position.copy(L.position),ee.rotation.copy(L.rotation),te.position.copy(C.position),te.rotation.copy(C.rotation);for(let t=0,o=q.length;t<o;t++)q[t][0].position.copy(q[t][1].translation()),q[t][0].quaternion.copy(q[t][1].rotation());e.drainCollisionEvents((t,o,i)=>{He.forEach((a,l)=>{var S,s;c.handle==t&&a.handle==o&&!A?c.linvel().z<15&&n.userData.boom==!1&&(z!=null&&w&&z.play(),m.removeImpulseJoint(Ie),b.userData.body.applyImpulse({x:5,y:5,z:5},!0),b.userData.body.setEnabledRotations(!0),Ee.setFriction(20),setTimeout(()=>{I=!1,g(We)},3e3),(S=ysdk.features.GameplayAPI)==null||S.stop(),n.userData.boom=!0):c.handle==t&&!A&&c.linvel().z<15&&n.position.y<5&&n.userData.boom==!1&&(z!=null&&w&&z.play(),m.removeImpulseJoint(Ie),b.userData.body.applyImpulse({x:5,y:5,z:5},!0),b.userData.body.setEnabledRotations(!0),Ee.setFriction(20),(s=ysdk.features.GameplayAPI)==null||s.stop(),n.userData.boom=!0,setTimeout(()=>{I=!1,g(We)},3e3))})})}}j.setAnimationLoop(()=>{De+=Bt.getDelta(),De>rt&&!F&&(Wt(),j.render(u,x),De=De%rt)}),document.addEventListener("touchend",Ut),document.addEventListener("touchstart",lt),document.addEventListener("touchmove",lt),window.addEventListener("keydown",Yt),window.addEventListener("keyup",Qt);function Vt(){Ue.forEach((e,t)=>{let o=e,i=Ye[t];i.setLinvel(o.userData.direction,!0),i.setAngvel({x:o.userData.direction.z,y:o.userData.direction.y,z:-o.userData.direction.x},!0);const a=o.userData.direction;o.userData.raycaster.set(new v(o.position.x,.4,o.position.z),a.clone().normalize());const l=o.userData.raycaster.intersectObjects(V);l.length>0&&l[0].distance<o.userData.size.x/2&&(o.userData.direction.x=o.userData.direction.x*-1)})}function Kt(){var a;n.position.z>Re.position.z&&!n.userData.boom&&(T=k.getElapsedTime().toFixed(3),Le.textContent=T,A=!0,(a=ysdk.features.GameplayAPI)==null||a.stop(),wt.textContent=T,_.levelsTimes["time"+W]!=null?K=_.levelsTimes["time"+W]:K=0,(T<K||K==0)&&(K=T,$e.textContent=K,_.levelsTimes["time"+W]=K,ae=Object.keys(_.levelsTimes).length,ae==qe.length&&(M=0,Object.values(_.levelsTimes).forEach(l=>{M+=parseFloat(l)}),de.textContent=O(Math.round(M*1e3)),de.classList.add("main_record_green"),console.log(Q),($&&Math.round(M*1e3)<Q||Q==0)&&me.setLeaderboardScore("main",Math.round(M*1e3)).then(()=>{ysdk.getLeaderboards().then(l=>{me=l,l.getLeaderboardEntries("main",{quantityTop:3,includeUser:!0,quantityAround:0}).then(S=>{document.querySelector(".records_wrap>div").innerHTML="",S.entries.forEach((s,B)=>{S.userRank==s.rank?(Q=s.score,document.querySelector(".records_wrap>div").innerHTML=document.querySelector(".records_wrap>div").innerHTML+'<p class = "main_record_green">'+parseInt(s.rank)+". "+O(s.score)+"</p>"):document.querySelector(".records_wrap>div").innerHTML=document.querySelector(".records_wrap>div").innerHTML+"<p>"+parseInt(B+1)+". "+O(s.score)+"</p>"})})})})),localStorage.setItem("playerData",JSON.stringify(_))),n.position.z=0),D.position.x+=n.userData.hTransition;const e=new v().subVectors(c.translation(),D.position).normalize(),t=c.linvel(),o=new v(e.x*-y[h].hSpeed,t.y,e.z*-y[h].nowSpeed);c.rotation().x<-.2&&c.setRotation({w:c.rotation().w,x:-.2,y:c.rotation().y,z:c.rotation().z}),c.translation().y<100&&c.translation().y>=20&&(y[h].nowSpeed+=.05,c.rotation().x<.04&&c.setRotation({w:c.rotation().w,x:.04,y:c.rotation().y,z:c.rotation().z})),c.translation().y<20&&c.translation().y>1&&c.lockRotations(!0,!0,!0,!0),c.setLinvel(o,!0),D.lookAt(D.position.x-(n.position.x-D.position.x),D.position.y-(n.position.y-D.position.y),D.position.z-(n.position.z-D.position.z)),c.setRotation({w:D.quaternion.w,x:c.rotation().x,y:D.quaternion.y,z:c.rotation().z}),b.userData.body.setRotation({w:D.quaternion.w,x:c.rotation().x,y:D.quaternion.y,z:c.rotation().z}),(ee.rotation.y>0||ee.rotation.y<0)&&L.userData.body.setRotation({w:L.userData.body.rotation().w,x:L.userData.body.rotation().x,y:0,z:L.userData.body.rotation().z}),(te.rotation.y>0||te.rotation.y<0)&&C.userData.body.setRotation({w:C.userData.body.rotation().w,x:C.userData.body.rotation().x,y:0,z:C.userData.body.rotation().z}),it.set(n.position,Ot);const i=it.intersectObjects(V);i.length>0&&(i[0].distance<.4?(n.userData.flying=!1,n.userData.onGround=!0):(n.userData.onGround=!1,n.userData.flying=!0)),c.linvel().z>0?n.userData.currentSpeed=c.linvel().z.toFixed(0):n.userData.currentSpeed=0,Ze.textContent=n.userData.currentSpeed,n.userData.left&&n.userData.onGround&&!n.userData.onStartArea&&(n.userData.hTransition<5&&(n.userData.hTransition+=y[h].maxHSpeed),y[h].nowSpeed-=.009),n.userData.right&&n.userData.onGround&&!n.userData.onStartArea&&(n.userData.hTransition>-5&&(n.userData.hTransition-=y[h].maxHSpeed),y[h].nowSpeed-=.009),y[h].resetHAngle&&!n.userData.left&&!n.userData.right&&(n.userData.hTransition<-y[h].maxHSpeed?n.userData.hTransition+=y[h].maxHSpeed:n.userData.hTransition>y[h].maxHSpeed?n.userData.hTransition-=y[h].maxHSpeed:n.userData.hTransition=0),n.position.z>_e.position.z?(n.userData.onStartArea==!0&&E&&document.querySelector(".anim_tap_top").classList.add("hidden_block"),Object.keys(_.levelsTimes).length==0&&document.querySelector(".svg_text").classList.add("hidden_block"),n.userData.onStartArea==!0&&E&&document.querySelector(".anim_tap_left").classList.remove("hidden_block"),n.userData.onStartArea==!0&&E&&document.querySelector(".anim_tap_right").classList.remove("hidden_block"),n.userData.onStartArea==!0&&E&&setTimeout(()=>{document.querySelector(".anim_tap_left").classList.add("hidden_block"),document.querySelector(".anim_tap_right").classList.add("hidden_block")},4e3),n.userData.onStartArea=!1):n.userData.onStartArea=!0}function lt(e){if(n.userData.onGround){e=e.changedTouches[0];var t=j.domElement.getBoundingClientRect();X.x=(e.clientX-t.left)/t.width*2-1,X.y=-((e.clientY-t.top)/t.height)*2+1,Pt.setFromCamera(X,x),X.y>0&&n.userData.canBoostStep&&I&&n.userData.onStartArea&&c.linvel().z<y[h].maxSpeed&&c.linvel().y<5&&c.linvel().y>-5&&!A&&y[h].nowSpeed<y[h].maxSpeed&&(y[h].nowSpeed+=y[h].stepSpeed),n.userData.canBoostStep=!1,X.y<.5&&(X.x>0?(n.userData.left=!1,n.userData.right=!0):(n.userData.right=!1,n.userData.left=!0))}}function Ut(e){n.userData.right=!1,n.userData.left=!1,n.userData.canBoostStep=!0}function Yt(e){switch(e.code){case"KeyW":case"ArrowUp":n.userData.canBoostStep&&I&&n.userData.onStartArea&&c.linvel().z<y[h].maxSpeed&&c.linvel().y<5&&c.linvel().y>-5&&!A&&y[h].nowSpeed<y[h].maxSpeed&&(y[h].nowSpeed+=y[h].stepSpeed),n.userData.canBoostStep=!1;break;case"KeyS":case"ArrowDown":break;case"KeyA":case"ArrowLeft":n.userData.left=!0;break;case"KeyD":case"ArrowRight":n.userData.right=!0;break}}function Qt(e){switch(e.code){case"KeyW":case"ArrowUp":n.userData.canBoostStep=!0;break;case"KeyS":case"ArrowDown":break;case"KeyA":case"ArrowLeft":n.userData.left=!1;break;case"KeyD":case"ArrowRight":n.userData.right=!1;break}}function R(e){let t,o;const i=e.rotation.clone();e.rotation.set(0,0,0);const a=new Y().setFromObject(e).getSize(new v);if(e.rotation.copy(i),e.name.includes("player")?(n.userData.size=a,n.userData.orgRotation=i,t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!0,!1,!1).setLinearDamping(0).setAngularDamping(2)),o=p.ColliderDesc.cuboid(a.x/6,a.y/1.8,a.z/3).setMass(e.userData.mass).setRestitution(0).setFriction(0),c=t,Ee=o,o.setActiveEvents(p.ActiveEvents.COLLISION_EVENTS),m.createCollider(o,t),n.userData.handle=c.handle,q.push([e,t,e.id])):e.name.includes("ground")&&(t=m.createRigidBody(p.RigidBodyDesc.fixed().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!0)),o=p.ColliderDesc.cuboid(a.x/2,a.y/2,a.z/2).setMass(e.userData.mass).setRestitution(0).setFriction(0),m.createCollider(o,t),ot=t,Z.userData.handle=ot.handle,q.push([e,t,e.id])),e.name.includes("wall")){t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!0,!0,!1).setLinearDamping(0)),o=p.ColliderDesc.cuboid(a.x/2,a.y/2,a.z/2).setMass(e.userData.mass*10).setRestitution(0).setFriction(40);let l=m.createCollider(o,t);He.push(l),q.push([e,t,e.id])}if(e.name.includes("moving_block")){t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!0,!0,!0,!0).setLinearDamping(0)),o=p.ColliderDesc.ball(a.x/2).setMass(e.userData.mass*10).setRestitution(0).setFriction(20);let l=t;Ye.push(l);let S=m.createCollider(o,t);He.push(S),q.push([e,t,e.id])}e.name.includes("itsmen_body")&&(t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!0,!1,!0).setLinearDamping(0).setAngularDamping(0)),o=p.ColliderDesc.cuboid(a.x/2,a.y/2,a.z/2).setMass(0).setRestitution(0).setFriction(0).setDensity(2),b.userData.body=t,b.userData.collider=o,m.createCollider(o,t),q.push([e,t,e.id])),e.name.includes("itsmen_left_hand")&&(t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!0,!1).setLinearDamping(0).setAngularDamping(0)),o=p.ColliderDesc.capsule(a.z/2,a.x/10).setMass(0).setRestitution(0).setFriction(0).setDensity(2),H.userData.body=t,H.userData.collider=o,m.createCollider(o,t),q.push([e,t,e.id])),e.name.includes("itsmen_right_hand")&&(t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!0,!1).setLinearDamping(0).setAngularDamping(0)),o=p.ColliderDesc.capsule(a.z/2,a.x/10).setMass(0).setRestitution(0).setFriction(0).setDensity(2),P.userData.body=t,P.userData.collider=o,m.createCollider(o,t),q.push([e,t,e.id])),e.name.includes("itsmen_left_leg")&&(t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!0,!1).setLinearDamping(0).setAngularDamping(0)),o=p.ColliderDesc.capsule(a.z/2,a.x/10).setMass(0).setRestitution(0).setFriction(0).setDensity(2),L.userData.body=t,L.userData.collider=o,m.createCollider(o,t),q.push([e,t,e.id])),e.name.includes("itsmen_right_leg")&&(t=m.createRigidBody(p.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!0,!1).setLinearDamping(0).setAngularDamping(0)),o=p.ColliderDesc.capsule(a.z/2,a.x/10).setMass(0).setRestitution(0).setFriction(0).setDensity(2),C.userData.body=t,C.userData.collider=o,m.createCollider(o,t),q.push([e,t,e.id]))}document.addEventListener("visibilitychange",function(){var e,t;document.visibilityState==="visible"?(se=!1,w&&F==!1&&!he&&(r==null||r.play()),c.linvel().z>3&&n.userData.onGround&&w&&F==!1&&(d==null||d.play()),!A&&I&&F==!1&&((e=ysdk.features.GameplayAPI)==null||e.start(),k.start(),k.elapsedTime=n.userData.time)):(se=!0,(t=ysdk.features.GameplayAPI)==null||t.stop(),f!=null&&f.isPlaying&&f.stop(),r==null||r.stop(),d==null||d.stop(),F==!1&&!A&&I&&(n.userData.time=k.getElapsedTime(),k.stop()))});
